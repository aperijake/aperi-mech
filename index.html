<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>aperi-mech: Performance Comparison Results</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <h1>Performance Comparison Results</h1>
    <h2>Benchmarks</h2>
    <h3>System: AperiAzureGPU2</h3>
    <ul>
        <li><a href="dev/bench/gtest/AperiAzureGPU2/index.html">Googletest Benchmarks</a></li>
        <li><a href="dev/bench/aperi_mech/AperiAzureGPU2/index.html">Executable Benchmarks</a></li>
        <li><a href="dev/bench/aperi_mech_detailed/AperiAzureGPU2/index.html">Detailed Executable Benchmarks</a></li>
    </ul>
    <h2>Timing Performance Summary</h2>
    <h3>Relative Difference (new - previous) / (previous total time of timer group)</h3>
    <div id="timing_plot_total"></div>
    <script>
	    // Load the JSON data
        function symlog(val) {
            return Math.sign(val) * Math.log10(1.0 + Math.abs(val));
        }
        fetch('performance_comparison_timing_results.json')
            .then(response => response.json())
            .then(data => {
                // Process the data for Plotly
                const names = data.map(d => d.name);
                const value_new = data.map(d => d.value_new);
                // Convert percent to factor
                const factor_total_difference = data.map(d => d.percent_total_difference / 100.0);
                const factor_total_difference_symlog = factor_total_difference.map(symlog);

                // Create the plot
                const trace = {
                    x: value_new,
                    y: factor_total_difference_symlog,
                    text: names,
                    mode: 'markers',
                    marker: {
                        size: 10,
                        color: 'rgba(156, 165, 196, 0.95)',
                        line: {
                            width: 1,
                            color: 'rgba(156, 165, 196, 1.0)'
                        }
                    },
                    type: 'scatter'
                };

                const data_plot = [trace];

                const layout = {
                    title: 'Performance Comparison (log x, symlog y)',
                    xaxis: {
                        title: 'New Value (seconds, log scale)',
                        type: 'log'
                    },
                    yaxis: {
                        title: 'Relative Difference (symlog scale)'
                    },
                    hovermode: 'closest'
                };

                Plotly.newPlot('timing_plot_total', data_plot, layout);
            });
    </script>
    <h3>Difference (new - previous) / (previous)</h3>
    <div id="timing_plot"></div>
    <script>
	    // Load the JSON data
        function symlog(val) {
            return Math.sign(val) * Math.log10(1.0 + Math.abs(val));
        }
        fetch('performance_comparison_timing_results.json')
            .then(response => response.json())
            .then(data => {
                // Process the data for Plotly
                const names = data.map(d => d.name);
                const value_new = data.map(d => d.value_new);
                // Convert percent to factor
                const factor_difference = data.map(d => d.percent_difference / 100.0);
                const factor_difference_symlog = factor_difference.map(symlog);

                // Create the plot
                const trace = {
                    x: value_new,
                    y: factor_difference_symlog,
                    text: names,
                    mode: 'markers',
                    marker: {
                        size: 10,
                        color: 'rgba(156, 165, 196, 0.95)',
                        line: {
                            width: 1,
                            color: 'rgba(156, 165, 196, 1.0)'
                        }
                    },
                    type: 'scatter'
                };

                const data_plot = [trace];

                const layout = {
                    title: 'Performance Comparison (log x, symlog y)',
                    xaxis: {
                        title: 'New Value (seconds, log scale)',
                        type: 'log'
                    },
                    yaxis: {
                        title: 'Relative Difference (symlog scale)'
                    },
                    hovermode: 'closest'
                };

                Plotly.newPlot('timing_plot', data_plot, layout);
            });
    </script>
    <h2>Memory Performance Summary</h2>
    <h3>Memory Difference (new - previous) / (previous)</h3>
    <div id="memory_plot"></div>
    <script>
	    // Load the JSON data
        function symlog(val) {
            return Math.sign(val) * Math.log10(1.0 + Math.abs(val));
        }
        fetch('performance_comparison_memory_results.json')
            .then(response => response.json())
            .then(data => {
                // Process the data for Plotly
                const names = data.map(d => d.name);
                const value_new = data.map(d => d.value_new);
                // Convert percent to factor
                const factor_difference = data.map(d => d.percent_difference / 100.0);
                const factor_difference_symlog = factor_difference.map(symlog);

                // Create the plot
                const trace = {
                    x: value_new,
                    y: factor_difference_symlog,
                    text: names,
                    mode: 'markers',
                    marker: {
                        size: 10,
                        color: 'rgba(156, 165, 196, 0.95)',
                        line: {
                            width: 1,
                            color: 'rgba(156, 165, 196, 1.0)'
                        }
                    },
                    type: 'scatter'
                };

                const data_plot = [trace];

                const layout = {
                    title: 'Performance Comparison (log x, symlog y)',
                    xaxis: {
                        title: 'New Value (MB, log scale)',
                        type: 'log'
                    },
                    yaxis: {
                        title: 'Relative Difference (symlog scale)'
                    },
                    hovermode: 'closest'
                };

                Plotly.newPlot('memory_plot', data_plot, layout);
            });
    </script>
</body>
</html>
